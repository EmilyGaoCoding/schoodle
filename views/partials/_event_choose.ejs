<script type="text/javascript" src="/scripts/event_choose.js"></script>

<form>
  <ul id="eventChoices" data-current-choice="<%= event.choice_id %>">
    <% var countArr = []; %>
    <% event_options.forEach(function(event_option) { %>
      <% var count = 0; %>
      <% event_option.votes.forEach(function(vote) { %>
        <% if (vote.isOK) { count++ } %>
      <% }); %>
      <% event_option["count"] = count; %>
      <% countArr.push(count) %>
    <% }); %>
    
    <% var maxCount = Math.max(countArr); %>
    <% event_options.forEach(function(event_option) { %>
      <% if (event_option.count === maxCount) { %>
        <a class="event-choice btn btn-danger btn-block" data-event-option-id="<% event_option.id %>"><i class="no material-icons right">clear</i><i class="yes material-icons right" hidden>check</i><%= event_option.option %><%= event_option.count %></a>
      <% } else { %>
        <a class="event-choice btn btn-danger btn-block" data-event-option-id="<% event_option.id %>"><i class="no material-icons right">clear</i><i class="yes material-icons right" hidden>check</i><%= event_option.option %><%= event_option.count %></a>
      <% } %>
    <% }) %>
  </ul>

  <button id="notify" class="btn btn-primary btn-block">Notify Participants</button>
</form>

    <!-- todo: highlight vote with the biggest count -->

    <!-- todo: once a final decision is made, users cannot vote anymore -->